@echo off
@setlocal enabledelayedexpansion enableextensions

CALL buildDebug.cmd

set BuildRoot=%~dp0..\bin\debug\
set VSTestPath=%PROGRAMFILES(x86)%\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\CommonExtensions\Microsoft\TestWindow\vstest.console.exe

CALL "%VSTestPath%" /UseVsixExtensions:true "%BuildRoot%Src\PerformanceCollector\Unit.Tests\Unit.Tests.dll" "%BuildRoot%Src\PerformanceCollector\Xdt.Tests\Xdt.Tests.dll" "%BuildRoot%Src\DependencyCollector\Net40.Tests\Microsoft.ApplicationInsights.DependencyCollector.Net40.Tests.dll" "%BuildRoot%Src\DependencyCollector\Net40.Tests\Microsoft.ApplicationInsights.TestFramework.Net40.dll" "%BuildRoot%Src\DependencyCollector\Net45.Tests\Microsoft.ApplicationInsights.DependencyCollector.Net45.Tests.dll" "%BuildRoot%Src\DependencyCollector\Net45.Tests\Microsoft.ApplicationInsights.TestFramework.Net45.dll" "%BuildRoot%Src\DependencyCollector\NetCore.Tests\netcoreapp1.0\Microsoft.AI.DependencyCollector.Tests.dll" "%BuildRoot%Src\DependencyCollector\Nuget.Tests\Microsoft.ApplicationInsights.DependencyCollector.NuGet.Tests.dll" "%BuildRoot%Src\Web\Web.Net40.Tests\Microsoft.ApplicationInsights.Web.Net40.Tests.dll" "%BuildRoot%Src\Web\Web.Net45.Tests\Microsoft.ApplicationInsights.Web.Net45.Tests.dll" "%BuildRoot%Src\Web\Web.Nuget.Tests\Microsoft.ApplicationInsights.Platform.Web.Nuget.Tests.dll" "%BuildRoot%Src\WindowsServer\WindowsServer.Net40.Tests\Microsoft.ApplicationInsights.TestFramework.Net40.dll" "%BuildRoot%Src\WindowsServer\WindowsServer.Net40.Tests\WindowsServer.Net40.Tests.dll" "%BuildRoot%Src\WindowsServer\WindowsServer.Net45.Tests\Microsoft.ApplicationInsights.TestFramework.Net45.dll" "%BuildRoot%Src\WindowsServer\WindowsServer.Net45.Tests\WindowsServer.Net45.Tests.dll" "%BuildRoot%Src\WindowsServer\WindowsServer.Nuget.Tests\WindowsServer.Nuget.Tests.dll" /logger:trx